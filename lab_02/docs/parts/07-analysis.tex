\chapter{Аналитическая часть}

\section{Алгоритм DES}

Шифровальная алгоритм DES (англ. \textit{Data Encryption Standart} --- DES) --- симметричный шифровальный алгоритм, разработанный в 1977 году компанией IBM. Он использует блочное шифрование, длина блока фиксирована и равна 64 битам. 
Однако каждые 8 бит в ключе игнорируются, что приводит к правильной длине ключа 56 бит в DES. 
Однако в любом случае один блок на 64 бита является вечной организацией DES.
Он состоит из 3 следующих шагов, рисунок~\ref{fig:des}: 
\begin{itemize}
	\item начальная перестановка (англ. \textit{Initial Permutation} --- IP), во время которой биты переставляются в порядке, определённом в специальной таблице;
	\item 16 раундов шифрования;
	\item завершающей перестановки (англ. \textit{Final Permutation} -- FP), соовершающей преобразования, обратные сделанным на первом шаге.
\end{itemize}

Раунд шифрования состоит из 5 следующих этапов
\begin{enumerate}[label=\arabic*)]
	\item расширение (англ. \textit{expansion} --- E);
	\item получение ключа раунда (англ. \textit{Round Key} -- RK);
	\item скремблирование (англ. \textit{substitution} --- S);
	\item перестановка (англ. \textit{permutation} --- P)
	\item смешивание ключа (англ. \textit{key mixing} --- KM).
\end{enumerate}

\clearpage

\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.7\linewidth]{img/des.png}
	\caption{Обобщенная схема шифрования в алгоритме DES}
	\label{fig:des}
\end{figure}

Расширение, во время которого каждая из половин блока шифрования по 32 бит дополняется путём перестановки и дублировоания бит до длины в 48 бит.

Получение ключа раунда необходимо для применения в раунде шифрования 48-битного ключа раунда, полученного из основного ключа DES. Основной ключ имеет длину 64 бита, однако значащих бит из 64 всего 56, остальные добавлены для избыточности и контроля передачи ключа. Из этих 56 бит получают 48 путём разбиения на равные части и применению битовой операции циклического сдвига и нахождению нового значения посредством специальной таблицы.

Скремблирование предназначено для получения из 48-битного потока 32-битного путём разбиения на 6 частей по 8 бит и обработки каждой части в S-блоках (англ. \textit{Substitution boxes}), которые заменяют блоки с длиной 6 бит на блоки 4 бит посредством использования специальной таблицы.

Перестановка представляет из себя перемешивания полученной последовательности из 32 бит при помощи таблицы перемешивания.

Смешивание ключа представляет из себя операцию XOR полученного 32-битного значения c ключом раунда.

\section{DES-CBC}

На рисунке \ref{fig:cbc} приведена схема алгоритма DES в режиме CBC.

\begin{figure}[ht!]
	\centering
	\includegraphics[width=0.7\linewidth]{img/cbc.png}
	\caption{Режим сцепления блоков шифротекста CBC}
	\label{fig:cbc}
\end{figure}
